# 表格測試

<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

## 上傳
<div id="upload-file">
<input type="file" id="xlsxFile" accept=".xlsx" onchange="handleFile()">
</div>

## 列印每頁標題與行數
<div id="worksheetsInfo"></div>

<script>
    {% include uploadXLSX.js %}
    {% include parseXLSX.js %}

function handleFile() {
    const reader = uploadXLSX('xlsxFile');
    if(reader){
        parseXLSX(reader).then((workbook) => {
            const worksheetsInfoDiv = document.getElementById('worksheetsInfo');
            worksheetsInfoDiv.innerHTML = '';  // Clear previous content
    
            // Iterate over each worksheet in the workbook
            for (let i = 0; i < workbook.SheetNames.length; i++) {
                const worksheetName = workbook.SheetNames[i];
                const worksheet = workbook.Sheets[worksheetName];
    
                const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
                const rowCount = jsonData.length;
    
                // Display the worksheet's title and row count
                const p = document.createElement('p');
                p.textContent = 'Title: ' + worksheetName + ', Row Count: ' + rowCount;
                worksheetsInfoDiv.appendChild(p);
            }
        }).catch((e)=>{
            console.log('Error reading file:', e);
        });
    }
}
</script>
