# 表格測試

<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

## 上傳
<div id="upload-file">
<input type="file" id="xlsxFile" accept=".xlsx" onchange="uploadFile()">
</div>

## 列印每頁標題與行數
<div id="worksheetsInfo"></div>

<script>
function uploadFile() {
    const xlsxFile = document.getElementById('xlsxFile').files[0];
    if (!xlsxFile) {
        alert('No file selected!');
        return;
    }

    const reader = new FileReader();
    reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, {type: 'array'});
        
        const worksheetsInfoDiv = document.getElementById('worksheetsInfo');
        worksheetsInfoDiv.innerHTML = '';  // Clear previous content

        // Iterate over each worksheet in the workbook
        for (let i = 0; i < workbook.SheetNames.length; i++) {
            const worksheetName = workbook.SheetNames[i];
            const worksheet = workbook.Sheets[worksheetName];

            const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
            const rowCount = jsonData.length;

            // Display the worksheet's title and row count
            const p = document.createElement('p');
            p.textContent = 'Title: ' + worksheetName + ', Row Count: ' + rowCount;
            worksheetsInfoDiv.appendChild(p);
        }
    };
    reader.readAsArrayBuffer(xlsxFile);
}
</script>


